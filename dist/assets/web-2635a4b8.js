import{W as w,t as s,v as g,x as p,y,z as C,A as E,O as i,B as S,P as u,E as m,F as d,G as h,C as R,T as I,D as O,H as v,J as U,K as k,L as P,M as W,Q as f,R as N,S as _,U as A,V as G,X as L,Y as T,Z as D,_ as F,$ as b,a0 as V,a1 as M,a2 as Y,a3 as x}from"./index-54bd6c42.js";class a extends w{constructor(){super(),s().onAuthStateChanged(t=>this.handleAuthStateChange(t))}async applyActionCode(e){const t=s();return g(t,e.oobCode)}async createUserWithEmailAndPassword(e){const t=s(),n=await p(t,e.email,e.password);return this.createSignInResult(n,null)}async confirmPasswordReset(e){const t=s();return y(t,e.oobCode,e.newPassword)}async confirmVerificationCode(e){throw new Error("Not implemented on web.")}async deleteUser(){const t=s().currentUser;if(!t)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return C(t)}async getCurrentUser(){const e=s();return{user:this.createUserResult(e.currentUser)}}async getIdToken(e){const t=s();if(!t.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return{token:await t.currentUser.getIdToken(e==null?void 0:e.forceRefresh)||""}}async getRedirectResult(){const e=s(),t=await E(e),n=t?i.credentialFromResult(t):null;return this.createSignInResult(t,n)}async getTenantId(){return{tenantId:s().tenantId}}async isSignInWithEmailLink(e){const t=s();return{isSignInWithEmailLink:S(t,e.emailLink)}}async linkWithApple(e){const t=new i(u.APPLE);this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),r=i.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithEmailAndPassword(e){const t=m.credential(e.email,e.password),n=await this.linkCurrentUserWithCredential(t);return this.createSignInResult(n,t)}async linkWithEmailLink(e){const t=m.credentialWithLink(e.email,e.emailLink),n=await this.linkCurrentUserWithCredential(t);return this.createSignInResult(n,t)}async linkWithFacebook(e){const t=new d;this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),r=d.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithGameCenter(){throw new Error("Not available on web.")}async linkWithGithub(e){const t=new h;this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),r=h.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithGoogle(e){const t=new R;this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),r=R.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithMicrosoft(e){const t=new i(u.MICROSOFT);this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),r=i.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithPhoneNumber(e){throw new Error("Not implemented on web.")}async linkWithPlayGames(){throw new Error("Not available on web.")}async linkWithTwitter(e){const t=new I;this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),r=I.credentialFromResult(n);return this.createSignInResult(n,r)}async linkWithYahoo(e){const t=new i(u.YAHOO);this.applySignInOptions(e||{},t);const n=await this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),r=i.credentialFromResult(n);return this.createSignInResult(n,r)}async reload(){const t=s().currentUser;if(!t)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return O(t)}async sendEmailVerification(){const t=s().currentUser;if(!t)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return v(t)}async sendPasswordResetEmail(e){const t=s();return U(t,e.email)}async sendSignInLinkToEmail(e){const t=s();return k(t,e.email,e.actionCodeSettings)}async setLanguageCode(e){const t=s();t.languageCode=e.languageCode}async signInAnonymously(){const e=s(),t=await P(e);return this.createSignInResult(t,null)}async setTenantId(e){const t=s();t.tenantId=e.tenantId}async signInWithApple(e){const t=new i(u.APPLE);this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),r=i.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithCustomToken(e){const t=s(),n=await W(t,e.token);return this.createSignInResult(n,null)}async signInWithEmailAndPassword(e){const t=s(),n=await f(t,e.email,e.password);return this.createSignInResult(n,null)}async signInWithEmailLink(e){const t=s(),n=await N(t,e.email,e.emailLink);return this.createSignInResult(n,null)}async signInWithFacebook(e){const t=new d;this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),r=d.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithGithub(e){const t=new h;this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),r=h.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithGoogle(e){const t=new R;this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),r=R.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithMicrosoft(e){const t=new i(u.MICROSOFT);this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),r=i.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithPhoneNumber(e){throw new Error("Not implemented on web.")}async signInWithPlayGames(){throw new Error("Not available on web.")}async signInWithGameCenter(){throw new Error("Not available on web.")}async signInWithTwitter(e){const t=new I;this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),r=I.credentialFromResult(n);return this.createSignInResult(n,r)}async signInWithYahoo(e){const t=new i(u.YAHOO);this.applySignInOptions(e||{},t);const n=await this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),r=i.credentialFromResult(n);return this.createSignInResult(n,r)}async signOut(){await s().signOut()}async unlink(e){const t=s();if(!t.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);const n=await _(t.currentUser,e.providerId);return{user:this.createUserResult(n)}}async updateEmail(e){const n=s().currentUser;if(!n)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return A(n,e.newEmail)}async updatePassword(e){const n=s().currentUser;if(!n)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return G(n,e.newPassword)}async updateProfile(e){const n=s().currentUser;if(!n)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return L(n,e)}async useAppLanguage(){s().useDeviceLanguage()}async useEmulator(e){const t=s(),n=e.port||9099;T(t,`${e.host}:${n}`)}handleAuthStateChange(e){const n={user:this.createUserResult(e)};this.notifyListeners("authStateChange",n)}applySignInOptions(e,t){if(e.customParameters){const n={};e.customParameters.map(r=>{n[r.key]=r.value}),t.setCustomParameters(n)}if(e.scopes)for(const n of e.scopes)t.addScope(n)}signInWithPopupOrRedirect(e,t){const n=s();return t==="redirect"?D(n,e):F(n,e)}linkCurrentUserWithPopupOrRedirect(e,t){const n=s();if(!n.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return t==="redirect"?b(n.currentUser,e):V(n.currentUser,e)}linkCurrentUserWithCredential(e){const t=s();if(!t.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return M(t.currentUser,e)}createSignInResult(e,t){const n=this.createUserResult((e==null?void 0:e.user)||null),r=this.createCredentialResult(t),l=this.createAdditionalUserInfoResult(e);return{user:n,credential:r,additionalUserInfo:l}}createCredentialResult(e){if(!e)return null;const t={providerId:e.providerId};return e instanceof Y&&(t.accessToken=e.accessToken,t.idToken=e.idToken,t.secret=e.secret),t}createUserResult(e){return e?{displayName:e.displayName,email:e.email,emailVerified:e.emailVerified,isAnonymous:e.isAnonymous,phoneNumber:e.phoneNumber,photoUrl:e.photoURL,providerId:e.providerId,tenantId:e.tenantId,uid:e.uid}:null}createAdditionalUserInfoResult(e){if(!e)return null;const t=x(e);if(!t)return null;const{isNewUser:n,profile:r,providerId:l,username:o}=t,c={isNewUser:n};return l!==null&&(c.providerId=l),r!==null&&(c.profile=r),o!=null&&(c.username=o),c}}a.ERROR_NO_USER_SIGNED_IN="No user is signed in.";export{a as FirebaseAuthenticationWeb};
